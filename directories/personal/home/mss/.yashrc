##### ~/.yashrc
### variables
# path
mypath="/usr/sbin:/usr/bin:/sbin:/bin"
mypath="$mypath:/mss/bin:/home/mss/execs"
#mypath="$mypath:/opt/llvm-10.0.0/bin"
#mypath="$mypath:/opt/node.js-13.9.0/bin"
#mypath="$mypath:/opt/rustc-1.42.0/bin"
export PATH="$mypath"

mypkgconfig="/usr/share/pkgconfig:/usr/lib/pkgconfig"
#mypkgconfig="$mypkgconfig:/opt/webkitgtk-2.28.0/lib/pkgconfig"
export PKG_CONFIG_PATH="$mypkgconfig"

export MPD_HOST="/var/lib/mpd/socket"

# lang
export LANG="en_US.utf8"

# compile bits
export MAKEFLAGS="-j 2"
export CFLAGS="-march=native -mtune=native"
export CXXFLAGS="${CFLAGS}"
export CHOST="x86_64-apathy-linux-musl"
export CBUILD="${CHOST}"
export CC="${CHOST}-gcc"
export CXX="${CHOST}-g++"
export ARCH="x86_64"
export buildforapathy="--prefix=/usr --disable-nls --disable-static --build=${CBUILD} --host=${CHOST}"
 
# default programs
export EDITOR="/usr/bin/vim"
export PAGER="/usr/bin/less"
export GPG_TTY=$(tty)

# xdg stuff
export XDG_DATA_DIRS="/usr/share"
export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CONFIG_DIRS="/etc/xdg"

# essential paths
export INFOPATH="/usr/info"
export MANPATH="/usr/share/man"
export INFOPATH="/usr/share/info"
export INPUTRC="/etc/inputrc"


### yash settings
HISTFILE=~/.yash_history HISTSIZE=30000
FCEDIT="/usr/bin/vim"

# prompts
[ $(id -u) -eq 0 ] && _user="\fb #" || _user="\fw $"
YASH_PS1='${_user} \fc[${${${PWD:/~/\~}##*/}:-$PWD}]\fD: '
YASH_PS1R=
YASH_PS1S=
YASH_PS2="\fc > \fD"
YASH_PS2R="\fc < \fD"
YASH_PS2S=

# ensure job control works
case $- in (*m*) trap - TSTP TTIN TTOU; esac
# colored ls without alias
ls() { command ls -h --color=tty "$@"; }
# initialize event handlers
COMMAND_NOT_FOUND_HANDLER=()
PROMPT_COMMAND=() 
YASH_AFTER_CD=()

# enable features
set --vi
set --brace-expand
set --extended-glob
set --no-unset
set --notify-le
set --hist-space

# set C-l to clear screen like zsh/bash
bindkey -av '\^L' clear-and-redraw-all

# set fbterm colors
[ "$TERM" = "linux" ] && [ ! "$(tty)" = "/dev/tty1" ] && /bin/ash /home/mss/execs/linuxcolors1.sh

### functions
# cd automatically when dirs are executed
_autocd()
if [ -d "$1" ]; then HANDLED=true; cd -- "$@"; break -i; fi
COMMAND_NOT_FOUND_HANDLER=('_autocd "$@"')

# check if running
cdo(){ cd "$OLDPWD";}

### aliases
## program related
alias tmux="tmux -2"
alias feh="feh -d --scale-down --auto-zoom"
alias fixfuckinggpg="gpg-connect-agent updatestartuptty /bye"
alias ytm="youtube-dl -f bestaudio -x --audio-format mp3 --audio-quality 0"
## make verbose
alias ln="ln -v"
alias cp="cp -v"
alias mv="mv -v"
alias mkdir="mkdir -pv"
alias mount="mount -v"
## shortcuts
##a literal shortcuts
alias nc="ncmpcpp"
alias s="startx --"
alias da="doas --"
alias a2="/mss/bin/a2norpc"
alias a2r="/mss/bin/a2rpc"
alias l="ls -Askh --color=tty"
alias ll="ls -Askhw1 --color=tty"
alias lll="ls -alh --color=tty"
alias grep="grep --color=auto"
alias poz="yash --posix"
alias mpvfb="mpv --profile=sw-fast --vo=drm --gpu-api=opengl"
alias fetchall="clear;fetch | tail -14;pver | tail -6;pkg stats | head -7 | tail -6"
alias fetchall_nc="(clear;fetch nocolor | tail -14;pver nocolor | tail -6;pkg nocolor | tail -6) | sed 's/\x1B\[[0-9;]\+[A-Za-z]//g'"
##b tmux
alias td="tmux detach"
alias ta="tmux attach"
alias tk="tmux kill-session -t"
alias tl="tmux ls"
##c git
alias gs="git status -s"
alias gpo="git push"
alias grs="git reset HEAD~1 --soft"
alias gcd1="git clone --depth=1"
##d sound
alias atog="amixer set Master toggle"
alias mtog="mpc toggle"
##e dirs
alias cdw="cd /mss/work"
alias cdr="cd /mss/repo"
alias cdt="cd /mss/tools"
alias cds="cd /mnt/mss/stuff"
alias cda="cd /mnt/mss/stuff/media/anime"
alias cdm="cd /mnt/mss/stuff/media/music"
alias cdg="cd /mnt/mss/stuff/techy-bits/git-repositories"
##f vim like exit
alias :q!="exit"
alias :wq="exit"
alias :wq!="exit"
##g init
alias reboot="doas -- kill -s INT 1"
alias poweroff="doas -- kill -s USR1 1"
