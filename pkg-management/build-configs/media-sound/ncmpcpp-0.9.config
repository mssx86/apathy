# > 1
tar xf /mss/work/sauces/fftw-3.3.8.tar.gz
cd fftw-3.3.8/

sed -e 's,AM_CONFIG_HEADER,AC_CONFIG_HEADERS,g' -i configure.ac
autoreconf -fi

./configure \
 --build=$CBUILD               \
 --host=$CHOST                 \
 --prefix=/mss/work/table/fftw \
\
 --disable-shared \
 --enable-static  \
 --enable-threads \
 --enable-openmp

make
make install

cd ..
rm -rf fftw-3.3.8/

# > 2
pushd /opt
doas -- tar xf \
 /mnt/mss/stuff/techy-bits/packaged-software/boost-1.72.0-gcc-9.3.0.tar.zst
popd

export      LDFLAGS="-L/opt/boost-1.72.0/lib -L/mss/work/table/fftw/lib"
export     CPPFLAGS="-I/opt/boost-1.72.0/include -I/mss/work/table/fftw/include"
export LIBRARY_PATH="/opt/boost-1.72.0/lib:/mss/work/table/fftw/lib"
export PKG_CONFIG_PATH="$PKG_CONFIG_PATH:/mss/work/table/fftw/lib/pkgconfig"

# > 3
gcd1 https://github.com/ncmpcpp/ncmpcpp.git
cd ncmpcpp

# > 4
./autogen.sh

./configure \
 --build=$CBUILD       \
 --host=$CHOST         \
 --prefix=/usr         \
\
 --enable-clock        \
 --with-fftw           \
 --with-taglib         \
 --enable-outputs      \
 --enable-visualizer   \
 --enable-static-boost \
\
 --with-boost=/opt/boost-1.72.0

# > 5
time make -j2

# > 6
cd src/
strip --strip-all -v ncmpcpp
pkgup ncmpcpp ncmpcpp-0.9-$(date "+%Y%m%d")-boost-1.72.0-gcc-9.3.0
