# > 1
git clone --depth=1 https://github.com/mssx86/mpd
cd mpd

# > 2
cdt1
tar xf /mnt/mss/stuff/techy-bits/packaged-software/boost-1.72.0.tar.zst

# > 3
mkdir mybuild
cd    mybuild

# > 4
export         LANG=C
export       LC_ALL=C
export       CFLAGS="${CFLAGS} -w"
export     CXXFLAGS="${CFLAGS}"

export      LDFLAGS="-L/mss/work/table/usr/lib"
export     CPPFLAGS="-I/mss/work/table/usr/include"
export   BOOST_ROOT="/mss/work/table/usr"
export LIBRARY_PATH="/mss/work/table/usr/lib"

meson \
 --prefix=/usr          \
\
 -Ddebug=false          \
 -Dipv6=disabled        \
 -Dtest=false           \
 -Ddocumentation=false  \
\
 -Dcue=true             \
 -Ddsd=true             \
 -Dtcp=true             \
 -Dfifo=true            \
 -Dpipe=true            \
 -Dhttpd=true           \
 -Dcurl=enabled         \
 -Dupnp=enabled         \
 -Ddatabase=true        \
 -Dffmpeg=enabled       \
 -Did3tag=enabled       \
 -Dwebdav=enabled       \
 -Dlibmpdclient=enabled \
..

# > 5
# >> create the mpd group and user
groupadd mpd
useradd -c "mpd thingy" -d /var/lib/mpd -u 45 -g mpd -s /bin/nologin mpd

# >> add mpd to the audio group
gpasswd -a mpd audio

# >> create essential directories and hand over the ownership
mkdir /var/lib/mpd
touch /var/lib/mpd/database
chown -R mpd:mpd /var/lib/mpd

# >> init script won't be working, run mpd with:
doas -u mpd mpd /etc/mpd.conf

# >> once it errors out, do:
doas -- chown -R mpd:mpd /var/lib/mpd/log

# >> now the init script will work properly.
