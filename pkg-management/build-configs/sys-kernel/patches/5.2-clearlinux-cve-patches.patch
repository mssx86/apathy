diff -uraN a/drivers/clk/sunxi/clk-sunxi.c b/drivers/clk/sunxi/clk-sunxi.c
--- a/drivers/clk/sunxi/clk-sunxi.c	2019-08-29 09:30:28.000000000 +0300
+++ b/drivers/clk/sunxi/clk-sunxi.c	2019-09-05 20:41:46.832393674 +0300
@@ -980,6 +980,8 @@
 		if (endp) {
 			derived_name = kstrndup(clk_name, endp - clk_name,
 						GFP_KERNEL);
+			if (!derived_name)
+				return NULL;
 			factors.name = derived_name;
 		} else {
 			factors.name = clk_name;
diff -uraN a/drivers/scsi/mpt3sas/mpt3sas_ctl.c b/drivers/scsi/mpt3sas/mpt3sas_ctl.c
--- a/drivers/scsi/mpt3sas/mpt3sas_ctl.c	2019-08-29 09:30:28.000000000 +0300
+++ b/drivers/scsi/mpt3sas/mpt3sas_ctl.c	2019-09-05 20:41:49.888393723 +0300
@@ -2319,6 +2319,10 @@
 			break;
 		}
 
+		if (karg.hdr.ioc_number != ioctl_header.ioc_number) {
+			ret = -EINVAL;
+			break;
+		}
 		if (_IOC_SIZE(cmd) == sizeof(struct mpt3_ioctl_command)) {
 			uarg = arg;
 			ret = _ctl_do_mpt_command(ioc, karg, &uarg->mf);
diff -uraN a/drivers/tty/vt/consolemap.c b/drivers/tty/vt/consolemap.c
--- a/drivers/tty/vt/consolemap.c	2019-08-29 09:30:28.000000000 +0300
+++ b/drivers/tty/vt/consolemap.c	2019-09-05 20:41:40.638393574 +0300
@@ -489,7 +489,11 @@
 	p2 = p1[n = (unicode >> 6) & 0x1f];
 	if (!p2) {
 		p2 = p1[n] = kmalloc_array(64, sizeof(u16), GFP_KERNEL);
-		if (!p2) return -ENOMEM;
+		if (!p2) {
+			kfree(p1);
+			p->uni_pgdir[n] = NULL;
+			return -ENOMEM;
+		}
 		memset(p2, 0xff, 64*sizeof(u16)); /* No glyphs for the characters (yet) */
 	}
 
diff -uraN a/sound/soc/codecs/wcd9335.c b/sound/soc/codecs/wcd9335.c
--- a/sound/soc/codecs/wcd9335.c	2019-08-29 09:30:28.000000000 +0300
+++ b/sound/soc/codecs/wcd9335.c	2019-09-05 20:41:44.054393629 +0300
@@ -2734,7 +2734,7 @@
 	char *dec;
 	u8 hpf_coff_freq;
 
-	widget_name = kstrndup(w->name, 15, GFP_KERNEL);
+	widget_name = kmemdup_nul(w->name, 15, GFP_KERNEL);
 	if (!widget_name)
 		return -ENOMEM;
 
